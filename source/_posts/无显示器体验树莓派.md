---
title: 无显示器体验树莓派
copyright: true
tags:
  - 树莓派
categories:
  - 树莓派
abbrlink: '8804'
date: 2019-03-11 18:44:49
---

{% note %}
去年入手了一块二手树莓派B，买回来的时候带有一块触摸屏，但烧完系统后一直是白屏。后来百度后才知道这块触摸屏是要装驱动才能用，但是仿佛陷入了一个死循环：显示屏没有驱动就不能显示，不能显示就不能装驱动。头大了好久还是去找资料，发现直接使用HDML接口的显示器是不需要装驱动的，淘宝一搜......一块屏幕的钱快赶上一块板子了。对于我这种穷人是怎么也狠不下心去买这个东西的。还好，穷有穷的办法，还真有不使用屏幕也能完美体验树莓派的法子，亲测可用。
{% endnote %}

<!--more-->

## 1. 材料准备

- 树莓派（包括电源和电源线）
- sd卡（8G以上）和读卡器
- 网线一根
- 电脑一台
- 手机（提供热点）

## 2. 软件安装

### 系统镜像下载

[官方系统镜像下载地址](https://www.raspberrypi.org/downloads/)

选择第二个

![系统镜像](https://i.loli.net/2019/03/11/5c86425a02190.png)

选择第一个或者第二个集成图形界面

![系统](https://i.loli.net/2019/03/11/5c8642e5e85d3.png)

下载完成后是一个压缩文件，解压后得到一个.img文件，这就是即将要烧录的系统文件。

### 烧录软件下载

[Win32DiskImager下载](https://sourceforge.net/projects/win32diskimager/)

![Win32DiskImager](https://i.loli.net/2019/03/11/5c8643f219a63.png)

这是一个开源软件，可以免费使用

### ssh客户端下载

因为没有显示器，所以解决办法就是ssh远程连接树莓派，然后可以开启vnc端口使用电脑远程登陆图形界面。这里有两个ssh客户端可供选择：

- [putty](https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html)
    ![putty](https://i.loli.net/2019/03/11/5c8645430df79.png)

这是一个开源的软件，可以免费使用。

- [Xshell](https://www.netsarang.com/zh/all-downloads/)
    ![Xshell](https://i.loli.net/2019/03/11/5c8651383a67e.png)

{% note success %}
建议连同Xftp一同安装。
Xshell和Xftp不是免费软件，但可以申请家庭和学校免费使用版，可以无限期试用。
[免费许可授权页面](https://www.netsarang.com/zh/free-for-home-school/)
{% endnote %}

## 3. 烧录系统

1. 用读卡器将sd卡插入电脑，并格式化。
2. 使用Win32DiskImager将系统烧录到sd卡。

    ![烧录](https://i.loli.net/2019/03/11/5c867a637a939.png)

3. 烧录完成后sd卡会出现两个分区，一个分区不能用，另一个是boot分区可以被电脑识别并打开，boot分区内容如下。

    ![烧录完成](https://i.loli.net/2019/03/11/5c867c8b44c48.png)

## 4. 开启ssh服务

由于从2016-11-25的系统开始默认ssh是关闭的，没开启ssh就无法连接电脑。由于没有显示器，不能在系统配置里面改，但可以在sd卡系统文件里做手脚。

在电脑上打开boot分区，在里面新建一个ssh的空文件，系统在启动的时候就可以识别出来并开启ssh服务。

![新建ssh](https://i.loli.net/2019/03/11/5c86805ea488c.gif)

{% note warning %}
这里的ssh文件没有后缀名的空文件，在windows系统新建文本文档后会有.txt的后缀，将电脑设置成后缀名可见，并将.txt删去。
sd卡在上电一次后ssh文件会消失，亲测不需要担心，因为ssh服务已经开启，以后默认开机启动
{% endnote %}

## 5. 用网线与电脑连接

1. 电脑连接手机热点，调出网路适配器设置界面

  ![网络适配器](https://i.loli.net/2019/03/12/5c874080e58b4.png)
2. 右键WLAN，选择`属性`，在共享中勾选`允许其他网络用户通过此计算机的Internet连接来连接`，并选择一个专用网络连接。

  ![共享](https://i.loli.net/2019/03/12/5c87411786546.gif)
3. `win+R`输入`cmd`后回车打开windows终端命令界面。英文模式下输入`arp -a`，查看当前所有使用的网关地址和网关的mac地址。
4. 树莓派插入sd卡，上电后用网线将树莓派连接到电脑的网路接口上。
5. 再次执行`arp -a`，找到树莓派的网卡信息

|                           连接前                           | 连接后                                                     |
| :--------------------------------------------------------: | :--------------------------------------------------------- |
| ![连接前](https://i.loli.net/2019/03/12/5c874710ea83d.png) | ![连接后](https://i.loli.net/2019/03/12/5c87474b6b7c3.png) |

6. 使用`ping`命令，依次ping树莓派的ip地址，找到能ping通的那一个，记下来。

## 6. 远程连接树莓派

### 使用ssh客户端远程连接树莓派

#### putty远程连接

1. 打开putty，远程连接刚才找到的ip地址
    ![putty连接](https://i.loli.net/2019/03/12/5c8749189315c.png)
2. 第一次连接需要保存密钥
    ![密钥](https://i.loli.net/2019/03/12/5c8749894376e.png)
3. 输入默认用户名`pi`和密码`raspberry`,然后就可以远程操纵树莓派了。
![puttyend](https://i.loli.net/2019/03/12/5c874d82c9551.png)

#### Xshell远程连接

1. 打开Xshell，新建会话

![Xshell远程连接](https://i.loli.net/2019/03/12/5c874c2292010.png)
2. 双击会话名称进行连接，第一次需要保存密钥
    ![保存密钥](https://i.loli.net/2019/03/12/5c874c718657d.png)
3. 输入默认用户名`pi`和密码`raspberry`,然后就可以远程操纵树莓派了。
![Xhellend](https://i.loli.net/2019/03/12/5c874d322f04c.png)

### 使用win10远程连接树莓派桌面

>前面两种方法都是使用ssh服务连接树莓派终端，只能使用树莓派的命令行界面，其实我们烧录的系统是有带桌面的,没有显示器也能使用桌面系统。

#### 使用win10自带远程桌面登陆

1. shell登陆树莓派，执行以下命令:
   ```bash
   sudo apt-get install xrdp #安装xrdp
   ```

2. 打开win10的`远程桌面连接`软件,填写树莓派ip
   ![远程连接](https://i.loli.net/2019/03/17/5c8d212cc5adb.png)

3. 输入树莓派用户名密码

   ![树莓派桌面登陆](https://i.loli.net/2019/03/17/5c8d21cab5580.png)

4. 登陆成功

   ![登陆成功](https://i.loli.net/2019/03/17/5c8d22aa6dc0f.png)

> 还有一种使用vnc登陆桌面的方法，无奈没有找到好用的软件，相比较而言还是win10自带的远程连接更方便美观。

## 7. 初次使用树莓派要做的几件事

### 修改密码

>树莓派的初始密码对于我来说过于难记，而且官方也建议修改密码，所以一般连接了树莓派第一件事就是改密码。

虽然图形界面更美观易用，但是图形界面也非常耗费内存，树莓派毕竟不是电脑，使用图形界面还是有点卡的，所以我觉得还是命令行界面更适合树莓派。
用ssh连接树莓派。在终端进行以下操作：

```bash
pi@raspberrypi:~ $ sudo passwd pi #修改pi用户的密码
Enter new UNIX password:          #输入你要修改的密码
Retype new UNIX password:         #再次输入密码
passwd: password updated successfully #密码修改成功
```

修改root密码也是如此。

### 配置wifi连接

>因为我介绍的是用网线连接的方法使用树莓派，但是以后不能总让树莓派连接着电脑，毕竟电脑还要使用网线连接校园网。所以需要配置树莓派的wifi连接电脑的热点，既能满足树莓派上网的需要，也能使用电脑真正做到远程连接。

1. ssh连接树莓派，终端输入`sudo raspi-config`
2. 选择网络配置
    ![网络配置](https://i.loli.net/2019/03/12/5c87527858b14.png)

3. 选择wifi配置
   ![WIFI](https://i.loli.net/2019/03/12/5c8752f358f3f.png)

4. 选择中国
   ![中国](https://i.loli.net/2019/03/12/5c87532964e1c.png)

5. 输入wifi名称和密码

|                       输入wifi名称                       |                       输入wifi密码                       |
| :------------------------------------------------------: | :------------------------------------------------------: |
| ![名称](https://i.loli.net/2019/03/12/5c87539cb8217.png) | ![密码](https://i.loli.net/2019/03/12/5c87539cb8217.png) |

6. 选择Finish。之后就可以断开树莓派与电脑，关闭之前打开的Internet连接共享。将电脑与校园网连接并开启移动热点，将名称和密码改成刚才在树莓派配置时一样。重启树莓派，找到树莓派的新ip。
   ![ip](https://i.loli.net/2019/03/12/5c8756a349dcc.png)

{% note waring %}
一定要记得关闭在网线连接电脑步骤中打开的Internet连接共享，否则会影响有线网络的正常使用。
{% endnote %}

以后就可以使用新的ip地址远程连接树莓派了。

### 安装vim编辑器

vim编辑器应该是linux系统必备软件，对于树莓派这种经常用字符界面的系统来说更是必不可少，安装步骤也极其简单

```bash
sudo apt-get install vim #安装vim
```

安装完成后，便可使用vim

### 更换国内软件源并更新软件

> Linux系统有个通病就是软件源速度慢，因为默认软件源是官方源，在中国访问速度很慢，所以一般都会在刚装玩系统后更新到中国本地软件源。

1. 备份当前软件源

```bash
sudo cp /etc/apt/sources.list /etc/apt/sources.list.old
```

2. 在网上搜索树莓派中国源，这里有一份[中科大源](<https://github.com/erhuoyan/config/tree/master/pi-sources>)，将sources.list文件里的内容替换树莓派本地的内容，我在测试的时候发现不能粘贴，这就导致容易打错字。更好的办法是使用xftp将sourcre.list文件上传到树莓派系统。

   ![sources](https://i.loli.net/2019/03/17/5c8d2a1ea8d76.gif)

3. 将sources.list文件剪切到/etc/apt/文件夹覆盖源文件即可

```bash
sudo mv sources.list /etc/apt/
```

4. 更新软件源

```bash
sudo apt-get update
```

之后再安装软件就会感觉速度快了很多。

> 另一个文件是在/etc/apt/sources.d文件夹内，是树莓派系统升级的源，可以使用同样的方法进行更新。